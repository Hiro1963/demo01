<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Touch Enikki Ver.0044</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <link rel="stylesheet" href="css/base.css" />
  <script src="https://code.createjs.com/1.0.0/createjs.min.js"></script>
  <script>
    var stage
//    var stageW
	var Dyshapes = [];
    var DyMvShape
    var MoveStarted = false;

    window.addEventListener("load", main);

    function main() {
      // 読み込みが終わってから初期化
      init();
      DyWord();
      DyButton();
      DyShapeDef();
    }

    function init() {
      // ステージを作成
      stage = new createjs.Stage("myCanvas");
//      stageW = new createjs.Stage("myCanvas");

      // タッチ操作をサポートしているブラウザーならば
      if (createjs.Touch.isSupported() == true) {
        // タッチ操作を有効にします。
        createjs.Touch.enable(stage)
      }
      
    }

    function DyWord() {
      // tick イベントを登録する
      createjs.Ticker.addEventListener("tick", handleTick);

      function handleTick(event) {
	    if (true == MoveStarted) {
	        // シェイプをマウスに追随させる
	        DyMvShape.x = stage.mouseX;
	        DyMvShape.y = stage.mouseY;
	    }

        // 画面を更新する
        stage.update();
      }
    }

    function DyShapeDef() {
		// オブジェクトの作成
	    var Dyshape1 = new createjs.Bitmap("star.png");
	    Dyshape1.x = 15;
	    Dyshape1.y = 325;
	    stage.addChild(Dyshape1);

	    var Dyshape2 = new createjs.Bitmap("star2.png");
	    Dyshape2.x = 100;
	    Dyshape2.y = 325;
	    stage.addChild(Dyshape2);

		// イベントを登録
//		Dyshape1.addEventListener("click", handleClick);
//		Dyshape2.addEventListener("click", handleClick);
		Dyshape1.addEventListener("touchstart", handleClick);
		Dyshape2.addEventListener("touchend", handleClick);
		function handleClick(event) {
			// クリックされた時の処理を記述
			DyMvShape = event.target;
		    if (true == MoveStarted) {
				MoveStarted = false;
//				if (DyMvShape.y < 270 ) {
//					stageW.addChild(DyMvShape);
//				}
			}
			else {
				MoveStarted = true;
			}
		}
    }

    function DyButton() {
      stage.enableMouseOver();

      // ボタンを作成
      var btn1 = createButton("WHEN", 93, 40, "#0275d8");
      btn1.x = 0;
      btn1.y = 270;
      stage.addChild(btn1);

      var btn2 = createButton("WHERE", 93, 40, "#d9534f");
      btn2.x = 93.75;
      btn2.y = 270;
      stage.addChild(btn2);

      var btn3 = createButton("WHO", 93, 40, "#5cb85c");
      btn3.x = 187.5;
      btn3.y = 270;
      stage.addChild(btn3);

      var btn4 = createButton("WHAT", 93, 40, "#5cb85c");
      btn4.x = 281.25;
      btn4.y = 270;
      stage.addChild(btn4);

      // イベントを登録
      btn1.addEventListener("click", handleClick);
      btn2.addEventListener("click", handleClick);
      btn3.addEventListener("click", handleClick);
      btn4.addEventListener("click", handleClick);
      function handleClick(event) {
      // クリックされた時の処理を記述
      DyDrawRect();
		alert(event.currentTarget + " がクリックされました。");
      }
    }

	/**
	 * CreateJSのボタンを作成する関数です。
	 * この関数でボタンを作ったらステージに追加したり、クリックイベントを登録しましょう。
	 * @param {String} text ボタンのラベル文言です。
	 * @param {Number} width ボタンの横幅(単位はpx)です。
	 * @param {Number} height ボタンの高さ(単位はpx)です。
	 * @param {String} keyColor ボタンのキーカラーです。
	 * @returns {createjs.Container} ボタンの参照を返します。
	 */
	function createButton(text, width, height, keyColor) {

	  // ボタン要素をグループ化
	  var button = new createjs.Container();
	  button.name = text; // ボタンに参考までに名称を入れておく(必須ではない)
	  button.cursor = "pointer"; // ホバー時にカーソルを変更する

	  // 通常時の座布団を作成
	  var bgUp = new createjs.Shape();
	  bgUp.graphics
	          .setStrokeStyle(1.0)
	          .beginStroke(keyColor)
	          .beginFill("white")
	          .drawRoundRect(0.5, 0.5, width - 1.0, height - 1.0, 4);
	  button.addChild(bgUp);
	  bgUp.visible = true; // 表示する

	  // ロールオーバー時の座布団を作成
	  var bgOver = new createjs.Shape();
	  bgOver.graphics
	          .beginFill(keyColor)
	          .drawRoundRect(0, 0, width, height, 4);
	  bgOver.visible = false; // 非表示にする
	  button.addChild(bgOver);

	  // ラベルを作成
	  var label = new createjs.Text(text, "18px sans-serif", keyColor);
	  label.x = width / 2;
	  label.y = height / 2;
	  label.textAlign = "center";
	  label.textBaseline = "middle";
	  button.addChild(label);

	  // ロールオーバーイベントを登録
	  button.addEventListener("mouseover", handleMouseOver);
	  button.addEventListener("mouseout", handleMouseOut);
	  function handleMouseOver(event) {
	    bgUp.visble = false;
	    bgOver.visible = true;
	    label.color = "white";
	  }

	  function handleMouseOut(event) {
	    bgUp.visble = true;
	    bgOver.visible = false;
	    label.color = keyColor;
	  }

	  return button;
	}

	function DyDrawRect() {
	
		//Graphicsオブジェクトを作成する
	    var g = new createjs.Graphics();

		//線の色を指定
	    g.beginStroke("#00ffff");

		//塗りつぶしの色を作成
//	    g.beginFill("#ffffff");

		// 線の幅を指定
		g.setStrokeStyle(5);

		//四角を描く(x:0,y:0を左上角とした幅100px,高さ100pxの四角)
	    g.drawRoundRect(2,313,372,238,30);

		//Displayオブジェクトを作成
	    var shape=new createjs.Shape(g);

		//シェイプオブジェクトをステージに追加する
	    stage.addChild(shape);
     
	}



</script>
</head>
<body>
  <canvas id="myCanvas" width="375" height="560"></canvas>
</body>
</html>